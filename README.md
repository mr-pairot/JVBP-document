# üìÑ JVBP Document Viewer (LINE LIFF + Google Sheets + Looker Studio)

‡∏£‡∏∞‡∏ö‡∏ö‡∏ô‡∏µ‡πâ‡∏ä‡πà‡∏ß‡∏¢‡πÉ‡∏´‡πâ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏¥‡∏î‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô Looker Studio ‡∏ú‡πà‡∏≤‡∏ô LINE LIFF ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏Å‡∏±‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏•‡∏á‡πÉ‡∏ô Google Sheets ‡πÇ‡∏î‡∏¢‡πÉ‡∏ä‡πâ LIFF, Netlify ‡πÅ‡∏•‡∏∞ Google Apps Script ‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô

---

## üîß ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ (Features)

- ‚úÖ ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö LINE Login (‡∏ú‡πà‡∏≤‡∏ô LIFF)
- ‚úÖ ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô Looker Studio ‡∏ï‡∏≤‡∏°‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ (RFA, RFI, Letter_IN)
- ‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÉ‡∏´‡∏°‡πà‡πÉ‡∏ô Google Sheet
- ‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å log ‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏¥‡∏î‡∏î‡∏π‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á
- ‚úÖ ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£ deploy ‡∏ú‡πà‡∏≤‡∏ô Netlify
- ‚úÖ ‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ú‡πà‡∏≤‡∏ô‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå `?docType=RFA`

---

## üìÅ ‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå

```
üì¶project-root
 ‚î£ üìÑ index.html         ‚Üê ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡∏´‡∏•‡∏±‡∏Å
 ‚î£ üìÑ script.js          ‚Üê ‡πÇ‡∏Ñ‡πâ‡∏î‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ LINE LIFF ‡πÅ‡∏•‡∏∞ Google Apps Script
 ‚î£ üìÑ style.css          ‚Üê ‡∏™‡πÑ‡∏ï‡∏•‡πå Spinner + Layout
 ‚îó üìÑ README.md          ‚Üê ‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ
```

---

## üöÄ ‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

### 1. ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏° LIFF App

- ‡πÑ‡∏õ‡∏ó‡∏µ‡πà [LINE Developers](https://developers.line.biz/console)
- ‡∏™‡∏£‡πâ‡∏≤‡∏á LIFF App
  - ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ LIFF URL ‡πÄ‡∏ä‡πà‡∏ô `https://document.netlify.app/?buttonName=RFA`
  - ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô LINE Login
  - ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å `LIFF ID` ‡∏°‡∏≤‡πÉ‡∏™‡πà‡πÉ‡∏ô `index.html`

---

### 2. ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏° Google Apps Script

- ‡πÄ‡∏õ‡∏¥‡∏î [https://script.new](https://script.new) ‡πÅ‡∏•‡πâ‡∏ß‡∏ß‡∏≤‡∏á `code.gs` ‡∏à‡∏≤‡∏Å‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡∏µ‡πâ
- ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ `SHEET_ID` ‡πÉ‡∏´‡πâ‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö Google Sheet ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
- `Deploy > Manage Deployments > New deployment`
  - Type: **Web app**
  - Execute as: **Me**
  - Access: **Anyone**
- ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å URL ‡∏°‡∏≤‡πÉ‡∏ä‡πâ‡πÉ‡∏ô `script.js`

> Apps Script ‡∏à‡∏∞:
> - ‡∏£‡∏±‡∏ö `GET` ‚Üí ‡∏™‡πà‡∏á Looker URL ‡∏Å‡∏•‡∏±‡∏ö
> - ‡∏£‡∏±‡∏ö `POST` ‚Üí ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å User log ‡πÅ‡∏•‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ

---

### 3. ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏° Looker Studio URLs

‡πÉ‡∏ô `code.gs` ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç `LOOKER_URLS` ‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ:

```js
const LOOKER_URLS = {
  'RFA': 'https://lookerstudio.google.com/embed/your-rfa-url',
  'RFI': 'https://lookerstudio.google.com/embed/your-rfi-url',
  'Letter_IN': 'https://lookerstudio.google.com/embed/your-letterin-url'
};
```

---

### 4. Deploy ‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏ß‡πá‡∏ö‡∏î‡πâ‡∏ß‡∏¢ Netlify

- Push ‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Å‡∏ï‡πå‡∏Ç‡∏∂‡πâ‡∏ô GitHub
- ‡πÑ‡∏õ‡∏ó‡∏µ‡πà [Netlify](https://www.netlify.com/)
  - ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å ‚ÄúImport from GitHub‚Äù
  - ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠ ‡πÄ‡∏ä‡πà‡∏ô: `document.netlify.app`
- ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡∏ó‡∏µ‡πà‡∏°‡∏µ Git Push

---

## üß™ ‡∏ß‡∏¥‡∏ò‡∏µ‡∏ó‡∏î‡∏™‡∏≠‡∏ö

1. ‡πÄ‡∏õ‡∏¥‡∏î‡∏ú‡πà‡∏≤‡∏ô LINE App ‡∏´‡∏£‡∏∑‡∏≠ Web Browser:
   - `https://document.netlify.app/?docType=RFA`
   - `https://document.netlify.app/?docType=RFI`
   - `https://document.netlify.app/?docType=Letter_IN`
2. ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÉ‡∏´‡πâ Login ‡∏ú‡πà‡∏≤‡∏ô LINE (‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢)
3. ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÇ‡∏´‡∏•‡∏î Looker Report ‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î ‡πÅ‡∏•‡∏∞‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏á Google Sheet

---

## üìå ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Google Sheet

### Sheet: `UserDATA`

| User ID | Display Name | FirstTimeLogin |
|---------|--------------|----------------|
| Uxxxx   | John Doe     | 2025-07-10     |

### Sheet: `UserLog`

| Timestamp           | User ID | Display Name | docType |
|---------------------|---------|--------------|---------|
| 2025-07-10 12:34:56 | Uxxxx   | John Doe     | RFA     |

---

## üìé ‡∏Ç‡πâ‡∏≠‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°

- ‡πÄ‡∏û‡∏¥‡πà‡∏° `LINE LIFF URL` ‡πÄ‡∏Ç‡πâ‡∏≤ Allow List ‡∏ö‡∏ô LINE Developer Console
- ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏´‡∏ô‡πâ‡∏≤ Looker Studio ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏î‡πâ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á Login (Public Embed)
- ‡πÉ‡∏ä‡πâ Netlify Environment Variables ‡∏ã‡πà‡∏≠‡∏ô `SCRIPT_URL` (‡πÉ‡∏ô‡∏£‡∏∞‡∏î‡∏±‡∏ö Production)

---

## üßë‚Äçüíª ‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏ó‡∏≥

- Pairot Huipan 
- ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ JVBP ‡∏ú‡πà‡∏≤‡∏ô Looker Studio
